<!doctype html>
<html>
<head>
	<meta charset="utf-8" />
	<meta name="renderer" content="webkit" />
	<meta name="keywords" content="" />
	<meta name="description" content="" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<base href="" target="_self" />
	<title>免费shadowsocks帐号</title>
	<link rel="stylesheet" type="text/css" href="./base.css" />
    <style type="text/css">
    body { padding-top:100px; font-family:\5fae\8f6f\96c5\9ed1;}
    .freess { width:999px; margin:0 auto; font-size:16px;}
    .freess dt { font-weight:bold;}
    .freess dl { float:left; width:333px; text-align:center;}
    .freess dd { margin-top:15px;}
    </style>
</head>

<body class="g-box">
	<div id="freess" class="freess f-clearfix"></div>
	<script type="text/javascript" src="./jquery.js"></script>
	<script type="text/javascript" src="./jquery.qrcode.js"></script>
	<script type="text/javascript" src="./base64.js"></script>
	<script type="text/javascript" src="./template.js"></script>
    <script type="text/html" id="tpl">
    {{each list as val key}}
    <dl>
        <dt>帐号{{key+1}}</dt>
        <dd>hostname：{{val.hostname}}</dd>
        <dd>port：{{val.port}}</dd>
        <dd>password：{{val.password}}</dd>
        <dd>method：{{val.method}}</dd>
        <dd><a href="javascript:void(0);" onclick="getQrcode(this, '{{val.hostname}}', '{{val.port}}', '{{val.password}}', '{{val.method}}')">生成二维码</a></dd>
        <dd class="qrcode"></dd>
    </dl>
    {{/each}}
    </script>
    <script type="text/javascript">
    $.get('./getss.php', function(res){
        var temp = res.match(/<div class="col-lg-4 text-center">[\s\S]+<\/font><\/h4>\s*<\/div>/)[0];
        if(temp){
            temp = '['+temp.replace(/<div class="col-lg-4 text-center">\s*<h4>[A-C]服务器地址:([\w\.]+)<\/h4>\s*<h4>端口:(\d+)<\/h4>\s*<h4>[A-C]密码:(\d+)<\/h4>\s*<h4>加密方式:([\w-]+)<\/h4>\s*<h4>状态:<font color="green">正常<\/font><\/h4>\s*<h4><font color="red">注意：每6小时更换一次密码<\/font><\/h4>\s*<\/div>\s*/g, '{"hostname":"$1", "port":"$2", "password":"$3", "method":"$4"},').replace(/,$/, '')+']';
            temp = eval('('+ temp +')');
            $('#freess').html(template('tpl', {list:temp}));
        }
    });
    
    function getQrcode(target, hostname, port, password, method){
        var base64 = 'ss://'+BASE64.encoder(method+':'+password+'@'+hostname+':'+port);
        $('.qrcode').empty();
        $(target).parent().next().qrcode({width:200, height:200, correctLevel:0, text:base64});
    }
    </script>
</body>
</html>